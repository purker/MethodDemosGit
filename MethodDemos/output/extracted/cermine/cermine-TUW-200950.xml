<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
  <front>
    <journal-meta />
    <article-meta>
      <title-group>
        <article-title>On the Complexity of Some Colorful Problems Parameterized by Treewidth ?</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <string-name>Michael Fellows</string-name>
          <email>michael.fellows@newcastle.edu.au</email>
          <xref ref-type="aff" rid="aff4">4</xref>
        </contrib>
        <contrib contrib-type="author">
          <string-name>Fedor V. Fomin</string-name>
          <email>fedor.fomin@ii.uib.no</email>
          <xref ref-type="aff" rid="aff1">1</xref>
        </contrib>
        <contrib contrib-type="author">
          <string-name>Daniel Lokshtanov</string-name>
          <email>Daniel.Lokshtanov@ii.uib.no</email>
          <xref ref-type="aff" rid="aff1">1</xref>
        </contrib>
        <contrib contrib-type="author">
          <string-name>Frances Rosamond</string-name>
          <email>frances.rosamond@newcastle.edu.au</email>
          <xref ref-type="aff" rid="aff4">4</xref>
        </contrib>
        <contrib contrib-type="author">
          <string-name>Saket Saurabh</string-name>
          <email>saket@ii.uib.no</email>
          <email>saket@imsc.res.in</email>
          <xref ref-type="aff" rid="aff1">1</xref>
          <xref ref-type="aff" rid="aff2">2</xref>
        </contrib>
        <contrib contrib-type="author">
          <string-name>Stefan Szeider</string-name>
          <email>stefan.szeider@durham.ac.uk</email>
          <xref ref-type="aff" rid="aff0">0</xref>
        </contrib>
        <contrib contrib-type="author">
          <string-name>Carsten Thomassen</string-name>
          <email>C.Thomassen@mat.dtu.dk</email>
          <xref ref-type="aff" rid="aff3">3</xref>
        </contrib>
        <aff id="aff0">
          <label>0</label>
          <institution>Department of Computer Science, Durham University</institution>
          ,
          <addr-line>Durham</addr-line>
          ,
          <country country="UK">U.K</country>
        </aff>
        <aff id="aff1">
          <label>1</label>
          <institution>Department of Informatics, University of Bergen</institution>
          ,
          <addr-line>Bergen</addr-line>
          ,
          <country country="NO">Norway</country>
        </aff>
        <aff id="aff2">
          <label>2</label>
          <institution>Institute of Mathematical Sciences</institution>
          ,
          <addr-line>Chennai</addr-line>
          ,
          <country country="IN">India</country>
        </aff>
        <aff id="aff3">
          <label>3</label>
          <institution>Mathematics Institute, Danish Technical University</institution>
          ,
          <addr-line>Lyngby</addr-line>
          ,
          <country country="DK">Denmark</country>
        </aff>
        <aff id="aff4">
          <label>4</label>
          <institution>University of Newcastle</institution>
          ,
          <addr-line>Newcastle</addr-line>
          ,
          <country country="AU">Australia</country>
        </aff>
      </contrib-group>
      <abstract>
        <p>We study the complexity of several coloring problems on graphs, parameterized by the treewidth t of the graph: (1) The list chromatic number χl(G) of a graph G is defined to be the smallest positive integer r, such that for every assignment to the vertices v of G, of a list Lv of colors, where each list has length at least r, there is a choice of one color from each vertex list Lv yielding a proper coloring of G. We show that the problem of determining whether χl(G) ≤ r, the LIST CHROMATIC NUMBER problem, is solvable in linear time for every fixed treewidth bound t. The method by which this is shown is new and of general applicability. (2) The LIST COLORING problem takes as input a graph G, together with an assignment to each vertex v of a set of colors Cv. The problem is to determine whether it is possible to choose a color for vertex v from the set of permitted colors Cv, for each vertex, so that the obtained coloring of G is proper. We show that this problem is W [1]-hard, parameterized by the treewidth of G. The closely related PRECOLORING EXTENSION problem is also shown to be W [1]-hard, parameterized by treewidth. (3) An equitable coloring of a graph G is a proper coloring of the vertices where the numbers of vertices having any two distinct colors differs by at most one. We show that the problem is hard for W [1], parameterized by (t, r). We also show that a list-based variation, L IST EQUITABLE COLORING is W [1]-hard for trees, parameterized by the number of colors on the lists. Topics: Parameterized Complexity, Bounded Treewidth, Graph Coloring</p>
      </abstract>
    </article-meta>
  </front>
  <body>
    <sec id="sec-1">
      <title>-</title>
      <p>Coloring problems that involve local and global restrictions on the coloring have many
important applications in such areas as operations research, scheduling and
computational biology, and also have a long mathematical history. For recent surveys of the
area one can turn to [Tu97,KTV98,Al00,Wo01] and also the book [JT95]. In this
paper we study the computational complexity of such problems, for graphs of bounded
treewidth, in the framework of parameterized complexity [DF99,Nie06], where we take
the parameter to be the treewidth bound t.</p>
      <p>Our main results are summarized:
– We show that the list chromatic number (also known as the choice number [KTV98])
of a graph can be computed in linear time for any fixed treewidth bound t. (We
prove this using a new “trick” for extending the applicability of Monadic Second
Order logic that is of general interest.)
– We show that LIST COLORING and PRECOLORING EXTENSION are W [1]-hard
for parameter t.
– We show that EQUITABLE COLORING is W [1]-hard parameterized by t.</p>
    </sec>
    <sec id="sec-2">
      <title>The problems are defined as follows.</title>
    </sec>
    <sec id="sec-3">
      <title>LIST CHROMATIC NUMBER</title>
      <p>Input: A graph G = (V, E) of treewidth at most t, and a positive integer r.
Parameter: t
Question: Is χl(G) ≤ r?</p>
    </sec>
    <sec id="sec-4">
      <title>LIST COLORING</title>
      <p>Input: A graph G = (V, E) of treewidth at most t, and for each vertex v ∈ V ,
a list L(v) of permitted colors.</p>
      <p>Parameter: t
Question: Is there a proper vertex coloring c with c(v) ∈ L(v) for each v?</p>
    </sec>
    <sec id="sec-5">
      <title>PRECOLORING EXTENSION</title>
      <p>Input: A graph G = (V, E) of treewidth at most t, a subset W ⊆ V of
precolored vertices, a precoloring cW of the vertices of W , and a positive integer r.
Parameter: t
Question: Is there a proper vertex coloring c of V which extends cW (that is,
c(v) = cW (v) for all v ∈ W ), using at most r colors?</p>
    </sec>
    <sec id="sec-6">
      <title>EQUITABLE COLORING (ECP)</title>
      <p>Input: A graph G = (V, E) of treewidth at most t and a positive integer r.
Parameter: t
Question: Is there a proper vertex coloring c using at most r colors, with the
property that the sizes of any two color classes differ by at most one?
Previous Results. LIST COLORING is NP-complete, even for very restricted classes
of graphs, such as complete bipartite graphs [JS97]. Jansen and Scheffler described a
dynamic programming algorithm for the problem that runs in time O(nt+2) for graphs
of treewidth at most t [JS97]. PRECOLORING EXTENSION is NP-complete, and can
also be solved in time O(nt+2) for graphs of treewidth at most t [JS97]. The LIST
CHROMATIC NUMBER problem is Π2p-complete for any fixed r ≥ 3, a result attributed
to Gutner and Tarsi [Tu97]. There does not appear to have been any previous result
on the complexity of the L IST CHROMATIC NUMBER problem for graphs of bounded
treewidth.</p>
      <sec id="sec-6-1">
        <title>Some Background on Parameterized Complexity.</title>
        <p>Parameterized complexity is basically a two-dimensional generalization of “P vs.
NP” where in addition to the overall input size n, one studies the effects on
computational complexity of a secondary measurement that captures additional relevant
information. This additional information can be, for example, a structural restriction on
the input distribution considered, such as a bound on the treewidth of an input graph.
Parameterization can be deployed in many different ways; for general background on
the theory see [DF99,FG06,Nie06].</p>
        <p>The two-dimensional analogue (or generalization) of P, is solvability within a time
bound of O(f (k)nc), where n is the total input size, k is the parameter, f is some
(usually computable) function, and c is a constant that does not depend on k or n.
Parameterized decision problems are defined by specifying the input, the parameter, and
the question to be answered. A parameterized problem that can be solved in such time
is termed fixed-parameter tractable (FPT). There is a hierarchy of intractable
parameterized problem classes above FPT, the main ones are:</p>
        <p>F P T ⊆ M [1] ⊆ W [1] ⊆ M [2] ⊆ W [2] ⊆ · · · ⊆ W [P ] ⊆ XP
The principal analogue of the classical intractability class NP is W [1], which is a strong
analogue, because a fundamental problem complete for W [1] is the k-STEP HALTING
PROBLEM FOR NONDETERMINISTIC TURING MACHINES (with unlimited
nondeterminism and alphabet size) — this completeness result provides an analogue of Cook’s
Theorem in classical complexity. A convenient source of W [1]-hardness reductions is
provided by the result that k-CLIQUE is complete for W [1]. Other highlights of the
theory include that k-DOMINATING SET, by contrast, is complete for W [2]. F P T = M [1]
if and only if the Exponential Time Hypothesis fails. XP is the class of all problems that
are solvable in time O(ng(k)).</p>
        <p>The principal “working algorithmics” way of showing that a parameterized problem
is unlikely to be fixed-parameter tractable is to prove W [1]-hardness. The key property
of a parameterized reduction between parameterized problems Π and Π0 is that the
input (x, k) to Π should be transformed to input (x0, k0) for Π0, so that the receiving
parameter k0 is a function only of the parameter k for the source problem.
1.1</p>
      </sec>
      <sec id="sec-6-2">
        <title>LIST CHROMATIC NUMBER Parameterized by Treewidth is FPT</title>
        <p>The notion of the list chromatic number (also known as the choice number) of a graph
was introduced by Vizing in 1976 [Viz76], and independently by Erdo¨s, Rubin and
Taylor in 1980 [ERT80]. A celebrated result that gave impetus to the area was proved
by Thomassen: every planar graph has list chromatic number at most five [Th94].</p>
        <p>We describe an algorithm for the LIST CHROMATIC NUMBER problem that runs in
linear time for any fixed treewidth bound t. Our algorithm employs the machinery of
Monadic Second Order (MSO) logic, due to Courcelle [Cou90] (also [ALS91,BPT92]).
At a glance, this may seem surprising, since there is no obvious way to describe the
problem in MSO logic — one would seemingly have to quantify over all possible list
assignments to the vertices of G, and the vocabulary of MSO seems not to provide
any way to do this. We employ a “trick” that was first described (to our knowledge) in
[BFLRRW06], with further applications described in [CFRRRS07,FGKPRWY07].</p>
        <p>The essence of the trick is to construct an auxiliary graph that consists of the original
input, augmented with additional semantic vertices, so that the whole ensemble has
— or can safely be assumed to have — bounded treewidth, and relative to which the
problem of interest can be expressed in MSO logic.</p>
        <p>A list assignment L with |L(v)| ≥ r for all v ∈ V is termed an r-list assignment. A
list assignment L from which G cannot be properly colored is called bad. Thus, a graph
G does not have list chromatic number χl(G) ≤ r, if and only if there is a bad r-list
assignment for G.</p>
        <p>The following lemma is crucial to the approach.</p>
        <p>Lemma 1. If a graph of treewidth at most t admits any bad r-list assignment, then it
admits a bad list assignment where the colors are drawn from a set of (2t + 1)r colors.
Proof. First of all, we may note that if G has treewidth bounded by t, then χl(G) ≤ t+1
(and similarly, the chromatic number of G is at most t + 1). This follows easily from
the inductive definition of t-trees. We can therefore assume that r ≤ t.</p>
        <p>Fix attention on a width t tree decomposition D for G, where the bags of the
decomposition are indexed by the tree T . For a node t of T , let D(t) denote the bag associated
to the node t. Suppose that L is a bad r-list assignment for G, and let C denote the union
of the lists of L. For a color α ∈ C, let Tα denote the subforest of T induced by the set
of vertices t of T for which D(t) contains a vertex v of G, where the color α occurs in
the list L(v). Let T (α) denote the set of trees of the forest Tα. Let T denote the union
of the sets T (α), taken over all of the colors α that occur in the list assignment L:
T = [ T (α)</p>
        <p>α∈C</p>
        <p>We consider that two trees T 0 and T 00 in T are adjacent if the distance between T 0
and T 00 in T is at most one. Note that T 0 and T 00 might not be disjoint, so the distance
between them can be zero. Let G denote the graph thus defined: the vertices of G are
the subtrees in T and the edges are given by the above adjacency relationship.</p>
        <p>Suppose that G can be properly colored by the coloring function c0 : T → C0. We
can use such a coloring to describe a modified list assignment L0[c0] to the vertices of G
in the following way: if T 0 ∈ T (α) and c0(T 0) = α0 ∈ C0, then replace each occurrence
of the color α on the lists L(v), for all vertices v that belong to bags D(t), where t ∈ T 0,
with the color α0.</p>
        <p>This specification of L0[c0] is consistent, because for any vertex v such that α ∈
L(v), there is exactly one tree T 0 ∈ T (α) such that v belongs to a bag indexed by
vertices of T 0.
Claim 1. If c0 is a proper coloring of G, and L is a bad list assignment for G, then L0[c0]
is also a bad list assignment for G.</p>
        <p>This follows because the trees in G preserve the constraints expressed in having a
given color on the lists of adjacent vertices of G, while the new colors α0 can only be
used on two different trees T 0 and T 00 when the vertices of G in the bags associated
with these trees are at a distance of at least two in G.</p>
        <p>Claim 2. The graph G has treewidth at most 2(t + 1)r − 1.</p>
        <p>A tree decomposition D0 for G of width at most 2(t + 1)r can be described as
follows. Subdivide each edge tt0 of T with a node of degree two denoted s(t, t0). Assign
to each node t the bag D0(t) consisting of those trees T 0 of G that include t. There
are at most (t + 1)r such trees. Assign to each node s(t, t0) the bag D0(s(t, t0)) =
D0(t) ∪ D0(t0). It is straightforward to verify that this satisfies the requirements of a tree
decomposition for G.</p>
        <p>The lemma now follows from the fact that G can be properly colored with 2(t + 1)r
colors. 2
Theorem 1. The LIST CHROMATIC NUMBER problem, parameterized by the treewidth
bound t, is fixed-parameter tractable, solvable in linear time for every fixed t.</p>
      </sec>
    </sec>
    <sec id="sec-7">
      <title>Proof. The algorithm consists of the following steps.</title>
      <p>Step 1. Compute in linear time, using Bodlaender’s algorithm, a tree-decomposition for
G of width at most t. Consider the vertices of G to be of type 1.</p>
      <p>Step 2. Introduce 2(t + 1)r new vertices of type 2, and connect each of these to all
vertices of G. The treewidth of this augmented graph is at most t + 2(t + 1)r = O(t2).
Step 3. The problem can now be expressed in MSO logic. That this is so, is not entirely
trivial, and is argued as follows (sketch). We employ a routine extension of MSO logic
that provides predicates for the two types of vertices.</p>
      <p>If G admits a bad r-list assignment, then this is witnessed by a set of edges F
between vertices of G (that is, type 1 vertices) and vertices of type 2 (that represent the
colors), such that every vertex v of G has degree r relative to F . Thus, the r incident
F -edges represent the colors of Lv. It is routine to assert the existence of such a set of
edges in MSO logic.</p>
      <p>The property that such a set of edges F represents a bad list assignment can be
expressed as: “For every subset F 0 ⊂ F such that every vertex of G has degree 1
relative to F 0 (and thus, F 0 represents a choice of a color for each vertex, chosen from
its list), there is an adjacent pair of vertices u and v of G, such that the represented color
choice is the same, i.e., u and v are adjacent by edges of F 0 to the same type 2
(colorrepresenting) vertex.” The translation of this statement into formal MSO is routine. 2
2</p>
      <sec id="sec-7-1">
        <title>Some Coloring Problems That Are Hard for Treewidth</title>
        <p>We tend to think that “all” (or almost all) combinatorial problems are easy for bounded
treewidth, but in the case of structured coloring problems, the game is more varied in
outcome .
2.1</p>
      </sec>
      <sec id="sec-7-2">
        <title>LIST COLORING and PRECOLORING EXTENSION are W [1]-Hard,</title>
        <sec id="sec-7-2-1">
          <title>Parameterized by Treewidth</title>
          <p>There is a relatively simple reduction to the L IST COLORING and PRECOLORING
EXTENSION problems from the MULTICOLORED CLIQUE problem. The MULTICOLORED
CLIQUE problem is known to be W [1]-complete [FHR07] (by a simple reduction from
the ordinary C LIQUE). The MULTICOLORED CLIQUE problem takes as input a graph
G together with a proper k-coloring of the vertices of G, and is parameterized by k.
The question is whether there is a k-clique in G consisting of exactly one vertex of each
color.</p>
          <p>As example of the reduction is shown in Figure 1. The figure shows, for the
parameter value k = 4, the construction of an instance G0 of LIST COLORING that admits a
proper choice of color from each list if and only if the source instance G has a multicolor
k-clique.</p>
          <p>The general construction can be easily infered from the example in Figure 1. The
colors on the lists are in 1:1 correspondence with the vertices of G. There are k vertices
v[i], i = 1, ..., k, one for each color class of G, and the list assigned to v[i] consists of
the colors corresponding to the vertices in G of color i. For i 6= j, there are various
vertices of degree two in G0, each having a list of size 2. There is one such degree two
vertex in G0 for each pair x, y of nonadjacent vertices, where x has color i and y has
color j.</p>
          <p>1</p>
          <p>Verification that the reduction works correctly is easy, and is left to the reader. The
treewidth of G0 is bounded by k + 1.</p>
          <p>Theorem 2. LIST COLORING parameterized by treewidth is W [1]-hard.</p>
          <p>To see that PRECOLORING EXTENSION is also W [1]-hard when parameterized by
treewidth, we can reduce from the LIST COLORING problem, simply using many
precolored vertices of degree 1 to enforce the lists. This construction does not increase the
treewidth. We have:
Theorem 3. PRECOLORING EXTENSION parameterized by treewidth is W [1]-hard.</p>
        </sec>
      </sec>
      <sec id="sec-7-3">
        <title>EQUITABLE COLORING is W [1]-Hard Parameterized by Treewidth</title>
        <p>The notion of equitable coloring seems to have been first introduced by Meyer in 1973,
where an application to scheduling garbage trucks is described [Mey73]. Recently,
Bodlaender and Fomin have shown that determining whether a graph of treewidth at most t
admits an equitable coloring, can be solved in time O(nO(t)) [BF05].</p>
        <p>We consider the parameterized complexity of EQUITABLE COLORING (ECP) in
graphs with bounded treewidth. We actually prove a stronger result than the one we
have so far stated. We show that when ECP is parameterized by (t, r), where t is the
treewidth bound, and r is the number of color classes, then the problem is W[1]-hard.</p>
        <p>To show the desired reduction, we introduce two more general problems. List
analogues of equitable coloring have been previously studied by Kostochka, et al. [KPW03].</p>
        <p>The LIST EQUITABLE COLORING PROBLEM (LECP): Given an input graph G =
(V, E), lists Lv of colors for every vertex v ∈ V and a positive integer r; does there
exist a proper coloring f of G with r colors that for every vertex v ∈ V uses a
color from its list Lv such that for any two color class, Vi and Vj of the coloring f ,
||Vi| − |Vj || ≤ 1?
The NUMBER LIST COLORING PROBLEM (NLCP): Given an input graph G =
(V, E), lists Lv of colors for every vertex v ∈ V , a function h : ∪v∈V Lv → N,
associating a number to each color, and a positive integer r; does there exist a proper
coloring f of G with r colors that for every vertex v ∈ V uses a color from its list
Lv, such that any color class Vc of the coloring f is of size h(c)?</p>
        <p>Our main effort is in the reduction of the M ULTICOLOR CLIQUE problem to NLCP.
Consider that the instance G = (V, E) of MULTICOLOR CLIQUE has its vertices
colored by the integers 1, ..., k. Let V [i] denote the set of vertices of color i, and let E[i, j],
for 1 ≤ i &lt; j ≤ k, denote the set of edges e = uv, where u ∈ V [i] and v ∈ V [j].
We can assume that |V [i]| = N for all i, and that |E[i, j]| = M for all i &lt; j, that
is, we can assume that the vertex color classes of G, and also the edge sets between
them, have uniform sizes. (For a simple justification of this assumption, we can reduce
MULTICOLOR CLIQUE to itself, taking a union of k! disjoint copies of G, one for each
permutation of the color set.)</p>
        <p>We will use following sets of colors in our construction of an instance of NLCP:
(1) S = {σ[i, j] : 1 ≤ i 6= j ≤ k}
(2) S0 = {σ0[i, j] : 1 ≤ i 6= j ≤ k}
(3) T = {τi[r, s] : 1 ≤ i ≤ k, 1 ≤ r &lt; s ≤ k, r 6= i, s 6= i}
(4) T 0 = {τi0[r, s] : 1 ≤ i ≤ k, 1 ≤ r &lt; s ≤ k, r 6= i, s 6= i}
(5) E = { [i, j] : 1 ≤ i &lt; j ≤ k}
(6) E 0 = { 0[i, j] : 1 ≤ i &lt; j ≤ k}</p>
        <p>Note that |S| = |S0| = 2 k2 , that is, there are distinct colors σ[2, 3] and σ[3, 2], etc.
In contrast, the colors τi[r, s] are only defined for r &lt; s.</p>
        <p>We associate with each vertex and edge of G a pair of (unique) identification
numbers. The up-identification number v[up] for a vertex v should be in the range [n2 +
1, n2 + n], if G has n vertices. Similarly, the up-identification number e[up] of an edge
e of G can be assigned (arbitrarily, but uniquely) in the range [2n2 + 1, 2n2 + m],
assuming G has m edges.</p>
        <p>Choose a suitably large positive integer Z0, for example Z0 = n3, and define the
down-identification number v[down] for a vertex v to be Z0 − v[up], and similarly for
the edges e of G, define the down-identification number e[down] to be Z0 − e[up].</p>
        <p>Choose a second large positive integer, Z1 &gt;&gt; Z0, for example, we may take
Z1 = n6.</p>
        <p>Next we describe various gadgets and the way they are combined in the reduction.
First we describe the gadget which encodes the selection of the edge going between
two particular color classes in G. In other words, we will think of the representation
of a k-clique in G as involving the selection of edges (with each edge selected twice,
once in each direction) between the color classes of vertices in G, with gadgets for
selection, and to check two things: (1) that the selections in opposite color directions
match, and (2) that the edges chosen from color class V [i] going to V [j] (for the various
j 6= i) all emanate from the same vertex in V [i]. (This is sometimes termed an edge
representation strategy for the parameterized reduction from M ULTICOLOR CLIQUE.)</p>
        <p>There are 2 k2 groups of gadgets, one for each pair of color indices i 6= j. If 1 ≤
i &lt; j ≤ k, then we will refer to the gadgets in the group G[i, j] as forward gadgets , and
we will refer to the gadgets in the group G[j, i] as backward gadgets.</p>
        <p>If e ∈ E[i, j], then there is one forward gadget corresponding to e in the group
G[i, j], and one backward gadget corresponding to e in the group G[j, i]. The
construction of these gadgets is described as follows.</p>
        <p>The forward gadget corresponding to e = uv ∈ E[i, j].</p>
        <p>The gadget has a root vertex r[i, j, e], and consists of a tree of height 2. The list assigned
to this root vertex contains two colors: σ[i, j] and σ0[i, j]. The root vertex has Z1 + 1
children, and each of these is also assigned the two-element list containing the colors
σ[i, j] and σ0[i, j]. One of the children vertices is distinguished, and has 2(k − 1) groups
of further children:
– e[up] children assigned the list {σ0[i, j], [i, j]}.
– e[down] children assigned the list {σ0[i, j], 0[i, j]}.
– For each r in the range j &lt; r ≤ k, u[up] children assigned the list {σ0[i, j], τi[j, r]}.
– For each r in the range j &lt; r ≤ k, u[down] children assigned {σ0[i, j], τi0[j, r]}.
– For each r in the range 1 ≤ r &lt; j, u[down] children assigned {σ0[i, j], τi[r, j]}.
– For each r in the range 1 ≤ r &lt; j, u[up] children assigned the list {σ0[i, j], τi0[r, j]}.
The backward gadget corresponding to e = uv ∈ E[i, j].</p>
        <p>The gadget has a root vertex r[j, i, e], and consists of a tree of height 2. The list assigned
to this root vertex contains two colors: σ[j, i] and σ0[j, i]. The root vertex has Z1 + 1
children, and each of these is also assigned the two-element list containing the colors
σ[j, i] and σ0[j, i]. One of the children vertices is distinguished, and has 2k groups of
further children:
– e[up] children assigned the list {σ0[j, i], 0[i, j]}.
– e[down] children assigned the list {σ0[j, i], [i, j]}.
– For each r in the range i &lt; r ≤ k, v[up] children assigned the list {σ0[j, i], τj[i, r]}.
– For each r in the range i &lt; r ≤ k, v[down] children assigned {σ0[j, i], τj0[i, r]}.
– For each r in the range 1 ≤ r &lt; i, v[down] children assigned {σ0[j, i], τj[r, i]}.
– For each r in the range 1 ≤ r &lt; i, v[up] children assigned the list {σ0[j, i], τj0[r, i]}.</p>
        <sec id="sec-7-3-1">
          <title>The numerical targets.</title>
          <p>(1) Each color in T ∪ T 0 has the target: Z0.
(2) Each color in E ∪ E 0 has the target: Z0.
(3) Each color in S has the target: (M − 1)(Z1 + 1) + 1.
(4) Each color in S0 has the target: (M − 1) + (Z1 + 1) + (k − 1)(M − 1)Z0.</p>
          <p>That completes the formal description of the reduction from M ULTICOLOR CLIQUE
to NLCP. We turn now to some motivating remarks about the design of the reduction.
Remarks on the colors, their numerical targets, and their role in the reduction.
(1) There are 2 k2 groups of gadgets. Each edge of G gives rise to two gadgets. Between
any two color classes of G there are precisely M edges, and therefore M · k2 edges
in G in total. Each group of gadgets therefore contains M gadgets. The gadgets in each
group have two “helper” colors. For example, the group of gadgets G[4, 2] has the helper
colors σ[4, 2] and σ0[4, 2]. The role of the gadgets in this group is to indicate a choice
of an edge going from a vertex in the color class V [4] of G to a vertex in the color class
V [2] of G. The role of the 2 k2 groups of gadgets is to represent the selection of k2
edges of G that form a k-clique, with each edge chosen twice, once in each direction. If
i &lt; j then the choice is represented by the coloring of the gadgets in the group G[i, j],
and these are the forward gadgets of the edge choice. If j &lt; i, then the gadgets in G[i, j]
are backward gadgets (representing the edge selection in the opposite direction, relative
to the ordering of the color classes of G). The numerical targets for the colors in S ∪ S0
are chosen to force exactly one edge to be selected (forward or backward) by each group
of gadgets, and to force the gadgets that are colored in a way that indicates the edge was
not selected into being colored in a particular way (else the numerical targets cannot be
attained). The numerical targets for these colors are complicated, because of this role
(which is asymmetric between the pair of colors σ[i, j] and σ0[i, j]).
(2) The colors in T ∪ T 0 and E ∪ E 0 are organized in symmetric pairs, and each pair
is used to transmit (and check) information. Due to the enforcements alluded to above,
each “selection” coloring of a gadget (there will be only one possible in each group of
gadgets), will force some numbers of vertices to be colored with these pairs of colors,
which can be thought of as an information transmission. For example, when a gadget in
G[4, 2] is colored with a “selection” coloring, this indicates that the edge from which the
gadget arises is selected as the edge from the color class V [4] of G, to the color class
V [2]. There is a pair of colors that handles the information transmission concerning
which edge is selected between the groups G[2, 4] and G[4, 2]. (Of course, something
has to check that the edge selected in one direction, is the same as the edge selected in
the other direction.) There is something neat about the dual-color transmission channel
for this information. Each vertex and edge has two unique identification numbers, “up”
and “down”, that sum to Z0. To continue the concrete example, G[4, 2] uses the (number
of vertices colored by the) pair of colors [2, 4] and 0[2, 4] to communicate to G[2, 4]
about the edge selected. The signal from one side consists of e[up] vertices colored
[2, 4] and e[down] vertices colored 0[2, 4]. The signal from the other side consists of
e[down] vertices colored [2, 4] and e[up] vertices colored 0[2, 4]. Thus the numerical
targets for these colors allow us to check whether the same edge has been selected in
each direction (if each color target of Z0 is met). There is the additional advantage that
the amount of signal in each direction is the same: in each direction a total of Z0 colored
vertices, with the two paired colors, constitutes the signal. This means that, modulo the
discussion in (1) above, when an edge is not selected, the corresponding non-selection
coloring involves uniformly the same number (i.e., Z0) of vertices colored “otherwise”
for each of the (M − 1) gadgets colored in the non-selection way: this explains (part
of) the (k − 1)(M − 1)Z0 term in (4) of the numerical targets.
(3) In a similar manner to the communication task discussed above, each of the k − 1
groups of gadgets G[i, ] need to check that each has selected an edge from V [i] that
originates at the same vertex in V [i]. Hence there are pairs of colors that provide a
communication channel similar to that in (2) for this information. This role is played
by the colors in T ∪ T 0. (Because of the bookkeeping issues, this becomes somewhat
intricate in the formal definition of the reduction.)</p>
          <p>The above remarks are intended to aid an intuitive understanding of the reduction.
We now return to a more formal argument.</p>
          <p>Claim 1. If G has a k-multicolor clique, then G0 is a yes-instance to NLCP.</p>
          <p>The proof of this claim is relatively straightforward. The gadgets corresponding to
the edges of a k-clique in G are colored in a manner that indicates “selected” (for both
the forward and the backward gadgets) and all other gadgets are colored in manner
that indicates “non-selected”. The coloring that corresponds to “selected” colors the
root vertex with the color σ[i, j], and this forces the rest of the coloring of the gadget.
The coloring that corresponds to “non-selected” colors the root vertex with the color
σ0[i, j]. In this case the coloring of the rest of the gadget is not entirely forced, but if the
grandchildren vertices of the gadget are also colored with σ0[i, j], then all the numerical
targets will be met.</p>
          <p>Claim 2. Suppose that Γ is a list coloring of G0 that meets all the numerical targets.
Then in each group of gadgets, exactly one gadget is colored in a way that indicates
“selection”.</p>
          <p>We argue this as follows. There cannot be two gadgets in any group colored in the
“selection” manner, since this would make it impossible to meet the numerical target
for a color in S. If no gadget is colored in the “selection” manner, then again the targets
cannot be met for the colors in S ∪ S0 used in the lists for this group of gadgets.
Claim 3. Suppose that Γ is a list coloring of G0 that meets all the numerical targets.
Then in each group of gadgets, every gadget that is not colored in a way that indicates
“selection” must have all of its grandchildren vertices colored with the appropriate color
in S0.</p>
          <p>Claim 3 follows from Claim 2, noting that the numerical targets for the S0 colors
cannot be met unless this is so.</p>
          <p>It follows from Claims 2 and 3, that if Γ is a list coloring of G0 that meets all
the numerical targets, then in each group of gadgets, exactly one gadget is colored in
the “selection” manner, and all other gadgets are colored in a completely determined
“nonselection” manner. Each “selection” coloring of a gadget produces a numerical
signal (based on vertex and edge identification numbers) carried by the colors in T ∪ T 0
and E ∪ E 0, with two signals per color. The target of Z0 for these colors can only be
achieved if the selection colorings indicate a clique in G.</p>
          <p>Theorem 4. NLCP is W[1]-hard for trees, parameterized by the number of colors that
appear on the lists.</p>
          <p>The reduction from NLCP to LECP is almost trivial, achieved by padding with
isolated vertices having single-color lists.</p>
          <p>The reduction from LECP to ECP is described as follows. Create a clique of size r,
the number of colors occuring on the lists, and connect the vertices of this clique to the
vertices of G0 in a manner that enforces the lists. Since G0 is a tree, the treewidth of the
resulting graph is at most r. We have:
Theorem 5. EQUITABLE COLORING is W [1]-hard, parameterized by treewidth.
3</p>
        </sec>
      </sec>
      <sec id="sec-7-4">
        <title>Discussion and Open Problems</title>
        <p>Structured optimization problems, such as the coloring problems considered here, have
strong claims with respect to applications. A source of discussion of these applications
is the recent dissertation of Marx [Ma04]. It seems interesting and fruitful to consider
such problems from the parameterized point of view, and to investigate how such extra
problem structure (which tends to increase both computational complexity, and
realworld applicability) interacts with parameterizations (such as bounded treewidth), that
frequently lead to tractability.</p>
        <p>The outcome of the investigation here of some well-known locally and globally
constrained coloring problems has turned up a few surprises: first of all, that the L IST
CHROMATIC NUMBER problem is actually FPT, when we parameterize by treewidth.
It is also somewhat surprising that this good news does not extend to L IST COLORING,
PRECOLORING EXTENSION or EQUITABLE COLORING, all of which turn out to be
hard for W [1].</p>
        <p>There are many interesting open problems concerning the parameterized
complexity of “more structured” combinatorial optimization problems on graphs, parametered
by treewidth. We mention the following two:
(1) Is the LIST EDGE CHROMATIC NUMBER problem fixed-parameter tractable,
parameterized by treewidth?
(2) One can formulate a “list analogue” of the HAMILTONIAN PATH problem as
follows: each vertex is assigned a list that is a subset of {1, 2, ..., n} indicating the positions
in the ordering of the n vertices implicit in a Hamiltonian path that are permitted to the
vertex. Is the LIST HAMILTONIAN PATH problem FPT, parameterized by treewidth?</p>
      </sec>
    </sec>
  </body>
  <back>
    <ref-list>
      <ref id="ref1">
        <mixed-citation>
          [Al00]
          <string-name>
            <given-names>N.</given-names>
            <surname>Alon</surname>
          </string-name>
          .
          <article-title>Restricted colorings of graphs</article-title>
          . In:
          <article-title>Surveys in Combinatorics 1993 (K</article-title>
          . Walker, ed.),
          <source>London Math. Soc. Lecture Notes Series</source>
          <volume>187</volume>
          (Cambridge Univ. Press,
          <year>1993</year>
          ),
          <fpage>1</fpage>
          -
          <lpage>33</lpage>
          .
        </mixed-citation>
      </ref>
      <ref id="ref2">
        <mixed-citation>
          [ALS91]
          <string-name>
            <given-names>S.</given-names>
            <surname>Arnborg</surname>
          </string-name>
          ,
          <string-name>
            <given-names>J.</given-names>
            <surname>Lagergren</surname>
          </string-name>
          and
          <string-name>
            <given-names>D.</given-names>
            <surname>Seese</surname>
          </string-name>
          .
          <article-title>Easy problems for tree-decomposable graphs</article-title>
          .
          <source>J. Algorithms</source>
          <volume>12</volume>
          (
          <year>1991</year>
          ),
          <fpage>308</fpage>
          -
          <lpage>340</lpage>
          .
        </mixed-citation>
      </ref>
      <ref id="ref3">
        <mixed-citation>
          <string-name>
            <surname>[BF05] H. L. Bodlaender</surname>
            and
            <given-names>F. V.</given-names>
          </string-name>
          <string-name>
            <surname>Fomin</surname>
          </string-name>
          .
          <article-title>Equitable colorings of bounded treewidth graphs</article-title>
          .
          <source>Theoretical Computer Science</source>
          <volume>349</volume>
          (
          <year>2005</year>
          ),
          <fpage>22</fpage>
          -
          <lpage>30</lpage>
          .
        </mixed-citation>
      </ref>
      <ref id="ref4">
        <mixed-citation>
          <string-name>
            <surname>[BFLRRW06] H. L. Bodlaender</surname>
            ,
            <given-names>M.</given-names>
          </string-name>
          <string-name>
            <surname>Fellows</surname>
            ,
            <given-names>M.</given-names>
          </string-name>
          <string-name>
            <surname>Langston</surname>
            ,
            <given-names>M. A.</given-names>
          </string-name>
          <string-name>
            <surname>Ragan</surname>
            ,
            <given-names>F.</given-names>
          </string-name>
          <string-name>
            <surname>Rosamond</surname>
            and
            <given-names>M.</given-names>
          </string-name>
          <string-name>
            <surname>Weyer</surname>
          </string-name>
          .
          <article-title>Quadratic kernelization for convex recoloring of trees</article-title>
          .
          <source>Proceedings COCOON 2007, Springer-Verlag, Lecture Notes in Computer Science</source>
          ,
          <year>2007</year>
          , to appear.
        </mixed-citation>
      </ref>
      <ref id="ref5">
        <mixed-citation>
          <string-name>
            <surname>[BPT92] R. B. Borie</surname>
            ,
            <given-names>R. G.</given-names>
          </string-name>
          <string-name>
            <surname>Parker</surname>
            and
            <given-names>C. A.</given-names>
          </string-name>
          <string-name>
            <surname>Tovey</surname>
          </string-name>
          .
          <article-title>Automatic generation of linear-time algorithms from predicate calculus descriptions of problems on recursively generated graph families</article-title>
          .
          <source>Algorithmica</source>
          <volume>7</volume>
          (
          <year>1992</year>
          ),
          <fpage>555</fpage>
          -
          <lpage>581</lpage>
          .
        </mixed-citation>
      </ref>
      <ref id="ref6">
        <mixed-citation>
          [CFRRRS07]
          <string-name>
            <given-names>B.</given-names>
            <surname>Chor</surname>
          </string-name>
          ,
          <string-name>
            <given-names>M.</given-names>
            <surname>Fellows</surname>
          </string-name>
          ,
          <string-name>
            <given-names>M. A.</given-names>
            <surname>Ragan</surname>
          </string-name>
          ,
          <string-name>
            <given-names>I.</given-names>
            <surname>Razgon</surname>
          </string-name>
          ,
          <string-name>
            <given-names>F.</given-names>
            <surname>Rosamond</surname>
          </string-name>
          and
          <string-name>
            <given-names>S.</given-names>
            <surname>Snir</surname>
          </string-name>
          .
          <article-title>Connected coloring completion for general graphs: algorithms and complexity</article-title>
          .
          <source>Proceedings COCOON 2007, Springer-Verlag, Lecture Notes in Computer Science</source>
          ,
          <year>2007</year>
          , to appear.
        </mixed-citation>
      </ref>
      <ref id="ref7">
        <mixed-citation>
          [Cou90]
          <string-name>
            <given-names>B.</given-names>
            <surname>Courcelle</surname>
          </string-name>
          .
          <article-title>The monadic second-order logic of graphs I: Recognizable sets of finite graphs</article-title>
          .
          <source>Information and Computation</source>
          ,
          <volume>85</volume>
          :
          <fpage>12</fpage>
          -
          <lpage>75</lpage>
          ,
          <year>1990</year>
          .
        </mixed-citation>
      </ref>
      <ref id="ref8">
        <mixed-citation>
          [DF99]
          <string-name>
            <given-names>R. G.</given-names>
            <surname>Downey</surname>
          </string-name>
          and
          <string-name>
            <given-names>M. R.</given-names>
            <surname>Fellows</surname>
          </string-name>
          . Parameterized Complexity. Springer-Verlag,
          <year>1999</year>
          .
        </mixed-citation>
      </ref>
      <ref id="ref9">
        <mixed-citation>
          [ERT80]
          <string-name>
            <given-names>P.</given-names>
            <surname>Erdo</surname>
          </string-name>
          <article-title>¨s,</article-title>
          <string-name>
            <given-names>A. L.</given-names>
            <surname>Rubin</surname>
          </string-name>
          and
          <string-name>
            <given-names>H.</given-names>
            <surname>Taylor</surname>
          </string-name>
          . Choosability in graphs.
          <source>Congressus Numerantium</source>
          <volume>26</volume>
          (
          <year>1980</year>
          ),
          <fpage>122</fpage>
          -
          <lpage>157</lpage>
          .
        </mixed-citation>
      </ref>
      <ref id="ref10">
        <mixed-citation>
          [FG06]
          <string-name>
            <given-names>J.</given-names>
            <surname>Flum</surname>
          </string-name>
          and
          <string-name>
            <given-names>M.</given-names>
            <surname>Grohe</surname>
          </string-name>
          , Parameterized Complexity Theory , Springer-Verlag,
          <year>2006</year>
          .
        </mixed-citation>
      </ref>
      <ref id="ref11">
        <mixed-citation>
          <string-name>
            <surname>[FGKPRWY07] M. Fellows</surname>
            ,
            <given-names>P.</given-names>
          </string-name>
          <string-name>
            <surname>Giannopoulos</surname>
            ,
            <given-names>C.</given-names>
          </string-name>
          <string-name>
            <surname>Knauer</surname>
            ,
            <given-names>C.</given-names>
          </string-name>
          <string-name>
            <surname>Paul</surname>
            ,
            <given-names>F.</given-names>
          </string-name>
          <string-name>
            <surname>Rosamond</surname>
            ,
            <given-names>S.</given-names>
          </string-name>
          <string-name>
            <surname>Whitesides</surname>
            and
            <given-names>N.</given-names>
          </string-name>
          <string-name>
            <surname>Yu</surname>
          </string-name>
          .
          <article-title>The lawnmower and other problems: applications of MSO logic in geometry</article-title>
          .
          <source>Manuscript</source>
          ,
          <year>2007</year>
          .
        </mixed-citation>
      </ref>
      <ref id="ref12">
        <mixed-citation>
          <string-name>
            <surname>[FHR07] M. Fellows</surname>
            ,
            <given-names>D.</given-names>
          </string-name>
          <string-name>
            <surname>Hermelin</surname>
            and
            <given-names>F.</given-names>
          </string-name>
          <string-name>
            <surname>Rosamond</surname>
          </string-name>
          .
          <article-title>On the fixed-parameter intractability and tractability of multiple-interval graph properties</article-title>
          .
          <source>Manuscript</source>
          ,
          <year>2007</year>
          .
        </mixed-citation>
      </ref>
      <ref id="ref13">
        <mixed-citation>
          [JS97]
          <string-name>
            <given-names>K.</given-names>
            <surname>Jansen</surname>
          </string-name>
          and
          <string-name>
            <given-names>P.</given-names>
            <surname>Scheffler</surname>
          </string-name>
          .
          <article-title>Generalized colorings for tree-like graphs</article-title>
          .
          <source>Discrete Applied Mathematics</source>
          <volume>75</volume>
          (
          <year>1997</year>
          ),
          <fpage>135</fpage>
          -
          <lpage>155</lpage>
          .
        </mixed-citation>
      </ref>
      <ref id="ref14">
        <mixed-citation>
          [JT95]
          <string-name>
            <given-names>T. R.</given-names>
            <surname>Jensen</surname>
          </string-name>
          and
          <string-name>
            <given-names>B.</given-names>
            <surname>Toft</surname>
          </string-name>
          . Graph Coloring Problems . Wiley Interscience,
          <year>1995</year>
          .
        </mixed-citation>
      </ref>
      <ref id="ref15">
        <mixed-citation>
          [KPW03]
          <string-name>
            <given-names>A. V.</given-names>
            <surname>Kostochka</surname>
          </string-name>
          ,
          <string-name>
            <given-names>M. J.</given-names>
            <surname>Pelsmajer</surname>
          </string-name>
          and
          <string-name>
            <given-names>D. B.</given-names>
            <surname>West</surname>
          </string-name>
          .
          <article-title>A list analogue of equitable coloring</article-title>
          .
          <source>Journal of Graph Theory</source>
          <volume>44</volume>
          (
          <year>2003</year>
          ),
          <fpage>166</fpage>
          -
          <lpage>177</lpage>
          .
        </mixed-citation>
      </ref>
      <ref id="ref16">
        <mixed-citation>
          [KTV98]
          <string-name>
            <given-names>J.</given-names>
            <surname>Kratochvil</surname>
          </string-name>
          ,
          <string-name>
            <given-names>Z.</given-names>
            <surname>Tuza</surname>
          </string-name>
          and
          <string-name>
            <given-names>M.</given-names>
            <surname>Voigt</surname>
          </string-name>
          .
          <article-title>New trends in the theory of graph colorings: choosability and list coloring</article-title>
          . In:
          <article-title>Contemporary Trends in Discrete Mathematics (from DIMACS and DIMATIA to the future) (</article-title>
          <string-name>
            <given-names>R.</given-names>
            <surname>Graham</surname>
          </string-name>
          , et al.,
          <source>eds.)</source>
          ,
          <source>DIMACS Series in Discrete Mathematics and Theoretical Computer Science</source>
          , vol.
          <volume>49</volume>
          (
          <issue>AMS</issue>
          , Providence,
          <year>1999</year>
          ),
          <fpage>183</fpage>
          -
          <lpage>197</lpage>
          .
        </mixed-citation>
      </ref>
      <ref id="ref17">
        <mixed-citation>
          [Ma04]
          <string-name>
            <given-names>D.</given-names>
            <surname>Marx</surname>
          </string-name>
          .
          <article-title>Graph coloring with local and global constraints</article-title>
          .
          <source>Ph.D. dissertation</source>
          , Department of Computer Science and Information Theory, Budapest University of Technology and Economics,
          <year>2004</year>
          .
        </mixed-citation>
      </ref>
      <ref id="ref18">
        <mixed-citation>
          [Mey73] W. Meyer. Equitable coloring.
          <source>American Mathematical Monthly</source>
          <volume>80</volume>
          (
          <year>1973</year>
          ),
          <fpage>920</fpage>
          -
          <lpage>922</lpage>
          .
        </mixed-citation>
      </ref>
      <ref id="ref19">
        <mixed-citation>
          [Nie06]
          <string-name>
            <given-names>R.</given-names>
            <surname>Niedermeier</surname>
          </string-name>
          .
          <article-title>Invitation to Fixed Parameter Algorithms</article-title>
          . Oxford University Press,
          <year>2006</year>
          .
        </mixed-citation>
      </ref>
      <ref id="ref20">
        <mixed-citation>
          [Th94]
          <string-name>
            <given-names>C.</given-names>
            <surname>Thomassen</surname>
          </string-name>
          .
          <article-title>Every planar graph is 5-choosable</article-title>
          .
          <source>J. Combinatorial Theory Ser. B</source>
          <volume>62</volume>
          (
          <year>1994</year>
          ),
          <fpage>180</fpage>
          -
          <lpage>181</lpage>
          .
        </mixed-citation>
      </ref>
      <ref id="ref21">
        <mixed-citation>
          [Tu97]
          <string-name>
            <given-names>Z.</given-names>
            <surname>Tuza</surname>
          </string-name>
          .
          <article-title>Graph colorings with local constraints - A survey</article-title>
          .
          <source>Discussiones Mathematicae - Graph Theory</source>
          <volume>17</volume>
          (
          <year>1997</year>
          ),
          <fpage>161</fpage>
          -
          <lpage>228</lpage>
          .
        </mixed-citation>
      </ref>
      <ref id="ref22">
        <mixed-citation>
          [Viz76]
          <string-name>
            <given-names>V. G.</given-names>
            <surname>Vizing.</surname>
          </string-name>
          <article-title>Coloring the vertices of a graph in prescribed colors</article-title>
          .
          <source>Metody Diskret. Anal. v Teorii Kodov i Schem</source>
          <volume>29</volume>
          (
          <year>1976</year>
          ),
          <fpage>3</fpage>
          -
          <lpage>10</lpage>
          . (In Russian.)
        </mixed-citation>
      </ref>
      <ref id="ref23">
        <mixed-citation>
          [Wo01]
          <string-name>
            <given-names>D. R.</given-names>
            <surname>Woodall</surname>
          </string-name>
          .
          <article-title>List colourings of graphs, in: Surveys in Combinatorics 2001 (J</article-title>
          . W. P. Hirschfeld, ed.)
          <source>London Math. Soc. Lecture Notes Series</source>
          <volume>288</volume>
          (Cambridge Univ. Press,
          <year>2001</year>
          ),
          <fpage>269</fpage>
          -
          <lpage>301</lpage>
          .
        </mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>